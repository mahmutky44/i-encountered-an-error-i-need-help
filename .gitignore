import numpy as np
import pandas as pd
veri =pd.read_csv("veriSeti.csv",encoding='unicode_escape')
veri_copy=veri.copy()

from sklearn import preprocessing
sayisallastirma = preprocessing.LabelEncoder()

veri_copy["country_or_area"]=sayisallastirma.fit_transform(veri_copy["country_or_area"])
veri_copy["year"]=sayisallastirma.fit_transform(veri_copy["year"])
veri_copy["value"]=sayisallastirma.fit_transform(veri_copy["value"])
veri_copy["category"]=sayisallastirma.fit_transform(veri_copy["category"])


girisler=np.array(veri_copy.drop(["country_or_area"],axis=1))
cikis=np.array(veri_copy["country_or_area"])

from sklearn.model_selection import train_test_split
giris_egitim, giris_test, country_or_area_egitim, country_or_area_test = train_test_split(girisler,cikis, test_size=0.5,random_state=1)


from sklearn.naive_bayes import CategoricalNB
model = CategoricalNB()
model.fit(giris_egitim, country_or_area_egitim)
country_or_area_tahmin= model.predict(giris_test)


from sklearn.metrics import confusion_matrix
import seaborn as sns
import matplotlib.pyplot as plt
cm= confusion_matrix(country_or_area_test,country_or_area_tahmin)
index = ['Kolay','Normal','Zor','Çok kolay'] 
columns = ['Kolay','Normal','Zor','Çok kolay'] 

cm_df = pd.DataFrame(cm,columns,index)                      
plt.figure(figsize=(10,6))  
sns.heatmap(cm_df, annot=True,fmt="d")

from sklearn import metrics
print("Modelin Doğruluğu:",metrics.accuracy_score(country_or_area_test, country_or_area_tahmin))
